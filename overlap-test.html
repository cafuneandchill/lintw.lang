<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<link rel="stylesheet" type="text/css" href="./style.css">
	<title>Lintwese</title>
	<script src="./1.31/lintw.lang.js"></script>
	<script type="text/javascript">
		
	var lintw_char_song = "りらづされぐつげ"+
	                      "かどずにですこと"+
	                      "ためまもそべひぬ"+
	                      "せをはぢぱけてち"+
	                      "ねじのやみえぎざ"+
	                      "ぴおぶきゆんあぷ"+
	                      "がしびばふるぼぺ"+
	                      "よなくぞむだぜご"+
	                      "へぽほわうろいぁ";

	window.onload = function () {
		
		var httpObj = new XMLHttpRequest();
		httpObj.open("GET", "./english-words.txt", true);
		httpObj.onreadystatechange = function() {
		
			if (httpObj.readyState == 4) {
			
				var text = httpObj.responseText;
				var enList = text.split("\n");
				var result = { "りと" : [ "lintw" ] };
				
				// テキストファイルを１行ずつ走査する
				for(var i = 0; i < enList.length; i++) {
				
					var en = enList[i];
					if (en.length == 0) continue;
					
					var ret = lintw.lang.convertWord(en);
					
					if (result[ret.lintwese] != null) { result[ret.lintwese].push(en); }
					else { result[ret.lintwese] = [ en ]; }
				}
				
				// 結果のキー(lintwese)一覧をソートする
				var keyList = Object.keys(result).sort(function (a, b) {
				
					if (a.length < b.length) { return -1; }
					else if (a.length > b.length) { return 1; }
					for(var i = 0; i < a.length; i++) {
						
						var an = lintw_char_song.indexOf(a.charAt(i));
						var bn = lintw_char_song.indexOf(b.charAt(i));
						if (an != bn) return an - bn;
					}
					return 0;
				});
				
				// 出力する
				var str = "";
				for(var i = 0; i < keyList.length; i++) {
				
					var key = keyList[i];
					
					str += "<span class='lintwese'>" + key + "</span> { ";
					for(var j = 0; j < result[key].length; j++) {
					
						str += result[key][j] + " ";
					}
					str += "} <br />";
				}
				document.getElementById("result").innerHTML = str;
			}
		};
		httpObj.send(null);
	};
	
	</script>
</head>
<body>
	<div id="result" class="container"></div>
</body>
</html>
